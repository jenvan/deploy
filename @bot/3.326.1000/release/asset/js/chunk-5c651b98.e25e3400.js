(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5c651b98"],{"0ce9":function(e,t,a){"use strict";a("d0db")},6130:function(e,t,a){"use strict";a.r(t);var s=a("7a23");const o={class:"fields"};function i(e,t,a,i,l,c){const r=Object(s["resolveComponent"])("van-button"),n=Object(s["resolveComponent"])("van-picker"),d=Object(s["resolveComponent"])("van-popup"),m=Object(s["resolveComponent"])("van-cell"),u=Object(s["resolveComponent"])("van-field"),b=Object(s["resolveComponent"])("van-stepper"),h=Object(s["resolveComponent"])("van-radio"),p=Object(s["resolveComponent"])("van-radio-group"),f=Object(s["resolveComponent"])("van-sticky"),j=Object(s["resolveComponent"])("van-form"),O=Object(s["resolveComponent"])("BaseLayout");return Object(s["openBlock"])(),Object(s["createBlock"])(O,{title:c.title},{extra:Object(s["withCtx"])(()=>[Object(s["withDirectives"])(Object(s["createVNode"])(r,{icon:"plus",size:"small",style:{borderRadius:"10px 0 0 10px"},color:"#09F",onClick:c.onCreate},{default:Object(s["withCtx"])(()=>[Object(s["createTextVNode"])("新增模板")]),_:1},8,["onClick"]),[[s["vShow"],c.display("create")]])]),default:Object(s["withCtx"])(()=>[Object(s["createVNode"])(d,{show:i.state.showPicker,"onUpdate:show":t[1]||(t[1]=e=>i.state.showPicker=e),round:"",position:"bottom"},{default:Object(s["withCtx"])(()=>[Object(s["createVNode"])(n,{title:"选择策略模板",columns:i.state.list,"columns-field-names":{text:"name"},onCancel:t[0]||(t[0]=e=>i.state.showPicker=!1),onConfirm:c.onConfirm},null,8,["columns","onConfirm"])]),_:1},8,["show"]),Object(s["createVNode"])(j,{class:"form",onSubmit:c.onSubmit},{default:Object(s["withCtx"])(()=>[Object(s["withDirectives"])(Object(s["createVNode"])(m,{class:Object(s["normalizeClass"])(["strategy",i.state.list.length>0?"animate__animated animate__repeat-2 animate__flash":""]),border:!1,title:c.name,label:"共有 "+i.state.list.length+" 个策略模板","is-link":"",onClick:t[2]||(t[2]=e=>i.state.showPicker=!0)},null,8,["class","title","label"]),[[s["vShow"],c.display("choose")]]),Object(s["createElementVNode"])("div",o,[Object(s["withDirectives"])(Object(s["createVNode"])(u,{modelValue:i.state.strategy.name,"onUpdate:modelValue":t[3]||(t[3]=e=>i.state.strategy.name=e),name:"name",label:"策略名称",placeholder:"策略模板的标题",rules:[{required:c.display("name"),message:"必填项"}]},null,8,["modelValue","rules"]),[[s["vShow"],c.display("name")]]),Object(s["withDirectives"])(Object(s["createVNode"])(u,{modelValue:i.state.strategy.symbol,"onUpdate:modelValue":t[4]||(t[4]=e=>i.state.strategy.symbol=e),name:"symbol",label:"交易对",placeholder:"只支持USDT交易对",clearable:"",rules:[{required:c.display("symbol"),message:"必填项"}],readonly:"adjust"==a.action,formatter:c.formatter},null,8,["modelValue","rules","readonly","formatter"]),[[s["vShow"],c.display("symbol")]]),Object(s["withDirectives"])(Object(s["createVNode"])(u,{modelValue:i.state.strategy.amount,"onUpdate:modelValue":t[5]||(t[5]=e=>i.state.strategy.amount=e),name:"amount",label:"建仓金额",placeholder:"最少 10 USDT",rules:[{required:c.display("amount"),message:"必填项"}],type:"number",min:"10","right-icon":"warning-o"},null,8,["modelValue","rules"]),[[s["vShow"],c.display("amount")]]),Object(s["createVNode"])(u,{name:"rise_limit",label:"止盈率","right-icon":"warning-o"},{input:Object(s["withCtx"])(()=>[Object(s["createVNode"])(b,{class:"stepper",modelValue:i.state.strategy.rise_limit,"onUpdate:modelValue":t[6]||(t[6]=e=>i.state.strategy.rise_limit=e),step:"0.1",min:"0.1",max:"100"},null,8,["modelValue"]),Object(s["createTextVNode"])("%")]),_:1}),Object(s["createVNode"])(u,{name:"rise_offset",label:"止盈回调比例","right-icon":"warning-o"},{input:Object(s["withCtx"])(()=>[Object(s["createVNode"])(b,{class:"stepper",modelValue:i.state.strategy.rise_offset,"onUpdate:modelValue":t[7]||(t[7]=e=>i.state.strategy.rise_offset=e),step:"0.1",min:"0",max:"100"},null,8,["modelValue"]),Object(s["createTextVNode"])("%")]),_:1}),Object(s["createVNode"])(u,{name:"fall_limit",label:"补仓下跌率","right-icon":"warning-o"},{input:Object(s["withCtx"])(()=>[Object(s["createVNode"])(b,{class:"stepper",modelValue:i.state.strategy.fall_limit,"onUpdate:modelValue":t[8]||(t[8]=e=>i.state.strategy.fall_limit=e),step:"0.1",min:"0.1",max:"100"},null,8,["modelValue"]),Object(s["createTextVNode"])("%")]),_:1}),Object(s["createVNode"])(u,{name:"fall_offset",label:"补仓回调比例","right-icon":"warning-o"},{input:Object(s["withCtx"])(()=>[Object(s["createVNode"])(b,{class:"stepper",modelValue:i.state.strategy.fall_offset,"onUpdate:modelValue":t[9]||(t[9]=e=>i.state.strategy.fall_offset=e),step:"0.1",min:"0",max:"100"},null,8,["modelValue"]),Object(s["createTextVNode"])("%")]),_:1}),Object(s["createVNode"])(u,{name:"fall_count",label:"补仓次数","right-icon":"warning-o"},{input:Object(s["withCtx"])(()=>[Object(s["createVNode"])(b,{class:"stepper",modelValue:i.state.strategy.fall_count,"onUpdate:modelValue":t[10]||(t[10]=e=>i.state.strategy.fall_count=e),step:"1",min:"0",max:"10"},null,8,["modelValue"]),Object(s["createTextVNode"])("次")]),_:1}),Object(s["createVNode"])(u,{name:"fall_series",label:"补仓金额","right-icon":"warning-o"},{input:Object(s["withCtx"])(()=>[Object(s["createVNode"])(p,{modelValue:i.state.strategy.fall_series,"onUpdate:modelValue":t[11]||(t[11]=e=>i.state.strategy.fall_series=e)},{default:Object(s["withCtx"])(()=>[Object(s["createVNode"])(h,{class:"radio",name:0},{default:Object(s["withCtx"])(()=>[Object(s["createTextVNode"])("不补仓")]),_:1}),Object(s["createVNode"])(h,{class:"radio",name:1},{default:Object(s["withCtx"])(()=>[Object(s["createTextVNode"])("单倍建仓金额")]),_:1}),Object(s["createVNode"])(h,{class:"radio",name:2},{default:Object(s["withCtx"])(()=>[Object(s["createTextVNode"])("单倍递增：2、3、4、5...")]),_:1}),Object(s["createVNode"])(h,{class:"radio",name:3},{default:Object(s["withCtx"])(()=>[Object(s["createTextVNode"])("双倍递增：2、4、6、8...")]),_:1}),Object(s["createVNode"])(h,{class:"radio",name:4},{default:Object(s["withCtx"])(()=>[Object(s["createTextVNode"])("乘方递增：2、4、8、16...")]),_:1})]),_:1},8,["modelValue"])]),_:1}),Object(s["createVNode"])(u,{name:"stop_limit",label:"下跌止损比例","right-icon":"warning-o"},{input:Object(s["withCtx"])(()=>[Object(s["createVNode"])(b,{class:"stepper",modelValue:i.state.strategy.stop_limit,"onUpdate:modelValue":t[12]||(t[12]=e=>i.state.strategy.stop_limit=e),step:"0.1",min:"0.1",max:"100"},null,8,["modelValue"]),Object(s["createTextVNode"])("%")]),_:1}),Object(s["createVNode"])(u,{name:"stop_action",label:"止损动作","right-icon":"warning-o"},{input:Object(s["withCtx"])(()=>[Object(s["createVNode"])(p,{modelValue:i.state.strategy.stop_action,"onUpdate:modelValue":t[13]||(t[13]=e=>i.state.strategy.stop_action=e)},{default:Object(s["withCtx"])(()=>[Object(s["createVNode"])(h,{class:"radio",name:0},{default:Object(s["withCtx"])(()=>[Object(s["createTextVNode"])("挂起不再补仓")]),_:1}),Object(s["createVNode"])(h,{class:"radio",name:1},{default:Object(s["withCtx"])(()=>[Object(s["createTextVNode"])("清仓")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),Object(s["createVNode"])(f,{class:"submit","offset-bottom":0,position:"bottom"},{default:Object(s["withCtx"])(()=>[Object(s["createVNode"])(r,{block:"",type:"primary","native-type":"submit"},{default:Object(s["withCtx"])(()=>[Object(s["createTextVNode"])(Object(s["toDisplayString"])(c.title),1)]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1},8,["title"])}a("14d9");var l=a("5502"),c=a("2824"),r={components:{BaseLayout:c["a"]},props:{action:{type:String,default:"create"},id:{type:Number,default:0}},setup(){const e=Object(s["reactive"])({showPicker:!1,symbols:[],list:[],strategy:{},default:{rise_limit:3,rise_offset:.3,fall_limit:4,fall_offset:.4,fall_count:5,fall_series:2,stop_limit:30,stop_action:0},sid:0});return{state:e}},created(){this.state.strategy=this.state.default,this.$http.get("/exchange/symbol").then(e=>this.state.symbols=e),this.$http.post("/exchange/strategylist").then(e=>{if("modify"==this.action&&0==e.length)return this.$toast("还没有策略模板，请先增加"),this.$router.push("/my/strategy/create");this.state.list=e})},mounted(){this.id>0&&this.$http.post("/exchange/taskdetail?id="+this.id).then(e=>{this.state.strategy=this.change(e["strategy"],100)})},computed:{title(){let e={create:"新增策略模板",modify:"修改策略模板",adjust:"调整策略 #"+this.id,apply:"手动建仓"};return"undefined"!=typeof e[this.action]?e[this.action]:e.create},name(){return"modify"==this.action?"请先点击选择要修改的策略模板":"可点击选择策略模板，填充到下面表单中"},...Object(l["b"])(["uid"])},methods:{display(e){return"create"==e?"modify"==this.action:"choose"==e?"modify"==this.action||"apply"==this.action:"name"==e?"create"==this.action||"modify"==this.action:"symbol"==e?"adjust"==this.action||"apply"==this.action:"amount"==e&&"adjust"!=this.action},change(e,t){return{...e,rise_limit:e.rise_limit*t,rise_offset:e.rise_offset*t,fall_limit:e.fall_limit*t,fall_offset:e.fall_offset*t,fall_series:parseInt(e.fall_series),stop_limit:e.stop_limit*t,stop_action:parseInt(e.stop_action)}},formatter(e){let t=e.toUpperCase().replace(/[^\w]/g,"");return-1==this.state.symbols.join("|").toUpperCase().indexOf(t)?t.substring(0,t.length-1):t},onCreate(){this.state.strategy=this.state.default,this.$router.push("/my/strategy/create")},onConfirm(e){this.state.showPicker=!1,this.state.sid=e.id,this.state.strategy=this.change(e,100),this.$copy(e.id,!1)},onSubmit(e){let t="create,modify".indexOf(this.action)>-1?"strategy":"task",a="/exchange/"+t+"save",s=this.change(e,.01);if("modify"==this.action){if(0==this.state.sid)return this.$toast("请先选择要修改的策略模板");s["id"]=this.state.sid}if("adjust"==this.action){if(0==this.id)return this.$toast("缺少任务ID");s["id"]=this.id}"task"==t&&1==this.uid&&(s["test"]=1),this.$http.post(a,s).then(e=>{this.$router.push("/my/exchange")})}}},n=(a("0ce9"),a("6b0d")),d=a.n(n);const m=d()(r,[["render",i],["__scopeId","data-v-486e6d3a"]]);t["default"]=m},d0db:function(e,t,a){}}]);
//# sourceMappingURL=chunk-5c651b98.e25e3400.js.map